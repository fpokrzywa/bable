(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{172:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(157).A)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},285:(e,t,r)=>{"use strict";r.d(t,{$:()=>d});var a=r(5155),s=r(2115),o=r(4253),n=r(2085),l=r(9434);let i=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,t)=>{let{className:r,variant:s,size:n,asChild:d=!1,...c}=e,u=d?o.DX:"button";return(0,a.jsx)(u,{className:(0,l.cn)(i({variant:s,size:n,className:r})),ref:t,...c})});d.displayName="Button"},2523:(e,t,r)=>{"use strict";r.d(t,{p:()=>n});var a=r(5155),s=r(2115),o=r(9434);let n=s.forwardRef((e,t)=>{let{className:r,type:s,...n}=e;return(0,a.jsx)("input",{type:s,className:(0,o.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...n})});n.displayName="Input"},3728:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>I});var a=r(5155),s=r(2115),o=r(6766),n=r(285),l=r(4165),i=r(221),d=r(2177),c=r(5594),u=r(7759),f=r(2523),m=r(5695),p=r(4744),g=r(7481),x=r(172),h=r(7650),y=r(9434);function b(e){let{size:t="md",className:r}=e,s={sm:{container:"w-16 h-16",ring:"w-16 h-16 border-2",logo:{width:24,height:24}},md:{container:"w-24 h-24",ring:"w-24 h-24 border-[3px]",logo:{width:36,height:36}},lg:{container:"w-32 h-32",ring:"w-32 h-32 border-4",logo:{width:48,height:48}}}[t];return(0,a.jsxs)("div",{className:(0,y.cn)("relative flex items-center justify-center",s.container,r),children:[(0,a.jsx)("div",{className:(0,y.cn)("absolute rounded-full border-primary/30 border-t-primary animate-spin",s.ring),style:{animationDuration:"1.5s"}}),(0,a.jsx)("div",{className:"absolute flex items-center justify-center animate-float",children:(0,a.jsx)(o.default,{src:"/bablephish_logo.svg",alt:"BabelPhish Logo",width:s.logo.width,height:s.logo.height,className:"flex-shrink-0"})})]})}function v(e){let{message:t="Logging you in..."}=e,[r,o]=(0,s.useState)(!1);if((0,s.useEffect)(()=>{o(!0)},[]),!r)return null;let n=(0,a.jsx)("div",{className:"fixed inset-0 bg-background/90 backdrop-blur-sm z-[9999] flex items-center justify-center",children:(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,a.jsx)(b,{size:"lg"}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground font-medium",children:t})]})});return"undefined"!=typeof document&&document.body?(0,h.createPortal)(n,document.body):n}let w=c.Ik({email:c.Yj().email({message:"Invalid email address."}),password:c.Yj().min(1,{message:"Password is required."})});function j(e){let{onLoginSuccess:t}=e,r=(0,m.useRouter)(),{toast:o}=(0,g.dj)(),[l,c]=(0,s.useState)(!1),[h,y]=(0,s.useState)("Logging you in..."),b=(0,s.useRef)();(0,s.useEffect)(()=>()=>{b.current&&clearTimeout(b.current)},[]);let j=(0,d.mN)({resolver:(0,i.u)(w),defaultValues:{email:"",password:""}});async function N(e){c(!0),y("Logging you in...");try{let s=await (0,p.V5)(e.email,e.password);if(s.success){var a;y("Building your workspace..."),o({title:"Login Successful",description:"Welcome back, ".concat((null==(a=s.user)?void 0:a.first_name)||"User","!")}),t&&t(),await new Promise(e=>setTimeout(e,1500)),r.push("/dashboard"),b.current=setTimeout(()=>{c(!1)},1e4);return}o({title:"Login Failed",description:s.error||"Please check your credentials and try again.",variant:"destructive"}),c(!1)}catch(e){console.error("Login error:",e),o({title:"Login Error",description:"An unexpected error occurred. Please try again.",variant:"destructive"}),c(!1)}}return(0,a.jsxs)(a.Fragment,{children:[l&&(0,a.jsx)(v,{message:h}),(0,a.jsx)(u.lV,{...j,children:(0,a.jsxs)("form",{onSubmit:j.handleSubmit(N),className:"space-y-4",children:[(0,a.jsx)(u.zB,{control:j.control,name:"email",render:e=>{let{field:t}=e;return(0,a.jsxs)(u.eI,{children:[(0,a.jsx)(u.lR,{children:"Email"}),(0,a.jsx)(u.MJ,{children:(0,a.jsx)(f.p,{placeholder:"m@example.com",...t,disabled:l})}),(0,a.jsx)(u.C5,{})]})}}),(0,a.jsx)(u.zB,{control:j.control,name:"password",render:e=>{let{field:t}=e;return(0,a.jsxs)(u.eI,{children:[(0,a.jsx)(u.lR,{children:"Password"}),(0,a.jsx)(u.MJ,{children:(0,a.jsx)(f.p,{type:"password",...t,disabled:l})}),(0,a.jsx)(u.C5,{})]})}}),(0,a.jsx)(n.$,{type:"submit",className:"w-full",disabled:l,children:l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Logging in..."]}):"Login"})]})})]})}var N=r(6695);function I(){let[e,t]=(0,s.useState)(!1),r=(0,m.useRouter)();return(0,s.useEffect)(()=>{},[r]),(0,a.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-background",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(o.default,{src:"/bablephish_logo.svg",alt:"BabelPhish Logo",width:120,height:120,className:"mx-auto"}),(0,a.jsxs)("h1",{className:"text-4xl font-bold mt-6",children:[(0,a.jsx)("span",{className:"text-foreground",children:"I am "}),(0,a.jsx)("span",{className:"text-primary",children:"BabelPhish"})]}),(0,a.jsx)("span",{children:"the intelligent experience"}),(0,a.jsx)("br",{}),(0,a.jsxs)(l.lG,{open:e,onOpenChange:t,children:[(0,a.jsx)(l.zM,{asChild:!0,children:(0,a.jsx)(n.$,{className:"mt-8",children:"Login"})}),(0,a.jsxs)(l.Cf,{className:"sm:max-w-md",children:[(0,a.jsxs)(l.c7,{children:[(0,a.jsx)(l.L3,{children:"Login"}),(0,a.jsx)(N.BT,{children:"Enter your email below to login to your account."})]}),(0,a.jsx)(j,{onLoginSuccess:()=>t(!1)})]})]})]})})}},4165:(e,t,r)=>{"use strict";r.d(t,{Cf:()=>g,Es:()=>h,HM:()=>f,L3:()=>y,c7:()=>x,lG:()=>d,rr:()=>b,zM:()=>c});var a=r(5155),s=r(2115),o=r(5821),n=r(5318),l=r(2085),i=r(9434);let d=o.bL,c=o.l9,u=o.ZL,f=o.bm,m=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(o.hJ,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...s})});m.displayName=o.hJ.displayName;let p=(0,l.F)("fixed z-50 grid w-full gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",{variants:{size:{default:"max-w-lg left-[50%] top-[50%] translate-x-[-50%] translate-y-[-50%]",lg:"w-full max-w-4xl left-[50%] top-[50%] -translate-y-1/2 -translate-x-1/2",form:"max-w-md left-[50%] top-[50%] translate-x-[-50%] translate-y-[-50%]"}},defaultVariants:{size:"default"}}),g=s.forwardRef((e,t)=>{let{className:r,children:s,size:l,...d}=e;return(0,a.jsxs)(u,{children:[(0,a.jsx)(m,{}),(0,a.jsxs)(o.UC,{ref:t,className:(0,i.cn)(p({size:l}),r),...d,children:[s,(0,a.jsxs)(o.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(n.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});g.displayName=o.UC.displayName;let x=e=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...r})};x.displayName="DialogHeader";let h=e=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...r})};h.displayName="DialogFooter";let y=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(o.hE,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",r),...s})});y.displayName=o.hE.displayName;let b=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(o.VY,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",r),...s})});b.displayName=o.VY.displayName},4744:(e,t,r)=>{"use strict";r.d(t,{CF:()=>u,Ob:()=>g,V5:()=>p,VM:()=>f,eg:()=>m,f$:()=>h,kl:()=>c,qA:()=>x});var a=r(3464),s=r(5712),o=r(9509);let n=()=>{let e="https://n8n.agenticweaver.com/webhook/bp-get-user";return e||(console.warn("NEXT_PUBLIC_GET_USERS_URL is not configured. User management may not work correctly."),null)},l=()=>{let e="https://n8n.agenticweaver.com/webhook/bp-upsert-user";return e||(console.warn("NEXT_PUBLIC_USER_PROFILE_UPDATE_WEBHOOK_URL is not configured in .env file."),null)},i=()=>{let e=o.env.USER_PROFILE_WEBHOOK_URL;return e||(console.warn("USER_PROFILE_WEBHOOK_URL is not configured in .env file. Using fallback data."),null)},d=e=>({userId:e,username:"Default User",first_name:"Default",last_name:"User",email:e,bio:"Please configure your user profile webhook in the .env file to fetch real user data.",avatar:"https://i.pravatar.cc/150?u=".concat(e),roles:["User"]});async function c(e){let t=n();if(!t)return console.warn("NEXT_PUBLIC_GET_USERS_URL is not configured. Falling back to default user."),d(e);try{let r=await a.A.get(t,{params:{userId:e}});if(200===r.status&&r.data){let e=Array.isArray(r.data)?r.data[0]:r.data;if(e)return{...e,userId:e.userId||e._id,roles:e.roles||["User"]}}return console.warn("No user found for userId: ".concat(e)),null}catch(t){if(a.A.isAxiosError(t)){var r;(null==(r=t.response)?void 0:r.status)===404?console.warn("User not found (userId: ".concat(e,")")):console.error("Failed to fetch user by ID ".concat(e,":"),t.message)}else console.error("An unexpected error occurred:",t);return null}}async function u(){let e=n();if(!e)return[{...d("user1@example.com"),roles:["Admin"]},d("user2@example.com")];try{let t=await a.A.get(e,{params:{userId:"all"}});if(200===t.status&&Array.isArray(t.data))return t.data.map(e=>({...e,userId:e.userId||e._id,roles:e.roles||["User"]}));if(200===t.status&&t.data&&"object"==typeof t.data){let e=t.data.data||t.data.users||t.data.items||t.data.result;if(Array.isArray(e))return e.map(e=>({...e,userId:e.userId||e._id,roles:e.roles||["User"]}))}return console.warn("Webhook response for all users was not in a recognized array format. Returning empty array.",t.data),[]}catch(e){return console.error("Failed to get all users from webhook:",e),[]}}async function f(e){let t=i();if(!t)return d(e);try{let r=await a.A.get(t,{params:{userId:e}});if(200===r.status&&r.data){let e=Array.isArray(r.data)?r.data[0]:r.data;if(e)return{...e,userId:e._id||e.userId,roles:e.roles||["User"]}}return console.warn("Webhook returned status ".concat(r.status," or no data for ").concat(e,". Falling back to default user.")),d(e)}catch(t){if(a.A.isAxiosError(t)){var r;(null==(r=t.response)?void 0:r.status)===404?console.warn("User not found via webhook (userId: ".concat(e,"). Falling back to default user.")):console.error("Failed to get user profile from webhook for ".concat(e,":"),t.message)}else console.error("An unexpected error occurred:",t);return d(e)}}async function m(e){let t=l();if(!t)return console.error("Cannot update/create user profile: NEXT_PUBLIC_USER_PROFILE_UPDATE_WEBHOOK_URL is not configured."),!1;let r={...e};try{let e=await a.A.post(t,r);return 200===e.status||201===e.status}catch(e){return console.error("Failed to update/create user profile via webhook:",e),!1}}async function p(e,t){try{let t=await f(e);if(!t)return{success:!1,error:"Failed to retrieve user profile"};let r=await (0,s.F)(t.userId),a={loggedIn:!0,email:e,userId:t.userId,loginTime:new Date().toISOString()};return localStorage.setItem("session",JSON.stringify(a)),localStorage.setItem("userData",JSON.stringify({user:t,workspaces:r})),{success:!0,user:t,workspaces:r}}catch(e){return console.error("Login failed:",e),{success:!1,error:e instanceof Error?e.message:"Login failed"}}}function g(){try{let e=localStorage.getItem("userData");if(e){let t=JSON.parse(e);return{user:t.user||null,workspaces:t.workspaces||[]}}}catch(e){console.error("Failed to parse cached user data:",e)}return{user:null,workspaces:[]}}function x(e){try{let t=localStorage.getItem("userData");if(t){let r=JSON.parse(t);r.workspaces=e,localStorage.setItem("userData",JSON.stringify(r))}}catch(e){console.error("Failed to update cached workspaces:",e)}}function h(){localStorage.removeItem("session"),localStorage.removeItem("userData")}},5057:(e,t,r)=>{"use strict";r.d(t,{J:()=>d});var a=r(5155),s=r(2115),o=r(968),n=r(2085),l=r(9434);let i=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(o.b,{ref:t,className:(0,l.cn)(i(),r),...s})});d.displayName=o.b.displayName},5712:(e,t,r)=>{"use strict";r.d(t,{F:()=>s});var a=r(4477);let s=(0,a.createServerReference)("4035bf7dc66fc3a9d08f28f59154642d70276f3542",a.callServer,void 0,a.findSourceMapURL,"getWorkspaces")},6695:(e,t,r)=>{"use strict";r.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>i,Zp:()=>n,aR:()=>l,wL:()=>u});var a=r(5155),s=r(2115),o=r(9434);let n=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...s})});n.displayName="Card";let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",r),...s})});l.displayName="CardHeader";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("h3",{ref:t,className:(0,o.cn)("text-2xl font-semibold leading-none tracking-tight",r),...s})});i.displayName="CardTitle";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("p",{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",r),...s})});d.displayName="CardDescription";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("p-6 pt-0",r),...s})});c.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center p-6 pt-0",r),...s})});u.displayName="CardFooter"},7481:(e,t,r)=>{"use strict";r.d(t,{dj:()=>f});var a=r(2115);let s=0,o=new Map,n=e=>{if(o.has(e))return;let t=setTimeout(()=>{o.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);o.set(e,t)},l=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?n(r):e.toasts.forEach(e=>{n(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},i=[],d={toasts:[]};function c(e){d=l(d,e),i.forEach(e=>{e(d)})}function u(e){let{duration:t,...r}=e,a=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),o=()=>c({type:"DISMISS_TOAST",toastId:a});return c({type:"ADD_TOAST",toast:{...r,id:a,open:!0,onOpenChange:e=>{e||o()}}}),t&&setTimeout(()=>{o()},t),{id:a,dismiss:o,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:a}})}}function f(){let[e,t]=a.useState(d);return a.useEffect(()=>(i.push(t),()=>{let e=i.indexOf(t);e>-1&&i.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},7759:(e,t,r)=>{"use strict";r.d(t,{C5:()=>h,MJ:()=>x,eI:()=>p,lR:()=>g,lV:()=>d,zB:()=>u});var a=r(5155),s=r(2115),o=r(4253),n=r(2177),l=r(9434),i=r(5057);let d=n.Op,c=s.createContext({}),u=e=>{let{...t}=e;return(0,a.jsx)(c.Provider,{value:{name:t.name},children:(0,a.jsx)(n.xI,{...t})})},f=()=>{let e=s.useContext(c),t=s.useContext(m),{getFieldState:r,formState:a}=(0,n.xW)(),o=r(e.name,a);if(!e)throw Error("useFormField should be used within <FormField>");let{id:l}=t;return{id:l,name:e.name,formItemId:"".concat(l,"-form-item"),formDescriptionId:"".concat(l,"-form-item-description"),formMessageId:"".concat(l,"-form-item-message"),...o}},m=s.createContext({}),p=s.forwardRef((e,t)=>{let{className:r,...o}=e,n=s.useId();return(0,a.jsx)(m.Provider,{value:{id:n},children:(0,a.jsx)("div",{ref:t,className:(0,l.cn)("space-y-2",r),...o})})});p.displayName="FormItem";let g=s.forwardRef((e,t)=>{let{className:r,...s}=e,{error:o,formItemId:n}=f();return(0,a.jsx)(i.J,{ref:t,className:(0,l.cn)(o&&"text-destructive",r),htmlFor:n,...s})});g.displayName="FormLabel";let x=s.forwardRef((e,t)=>{let{...r}=e,{error:s,formItemId:n,formDescriptionId:l,formMessageId:i}=f();return(0,a.jsx)(o.DX,{ref:t,id:n,"aria-describedby":s?"".concat(l," ").concat(i):"".concat(l),"aria-invalid":!!s,...r})});x.displayName="FormControl",s.forwardRef((e,t)=>{let{className:r,...s}=e,{formDescriptionId:o}=f();return(0,a.jsx)("p",{ref:t,id:o,className:(0,l.cn)("text-sm text-muted-foreground",r),...s})}).displayName="FormDescription";let h=s.forwardRef((e,t)=>{var r;let{className:s,children:o,...n}=e,{error:i,formMessageId:d}=f(),c=i?String(null!=(r=null==i?void 0:i.message)?r:""):o;return c?(0,a.jsx)("p",{ref:t,id:d,className:(0,l.cn)("text-sm font-medium text-destructive",s),...n,children:c}):null});h.displayName="FormMessage"},7982:(e,t,r)=>{Promise.resolve().then(r.bind(r,3728))},9434:(e,t,r)=>{"use strict";r.d(t,{cn:()=>o});var a=r(2596),s=r(9688);function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,a.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[802,977,195,521,441,684,358],()=>t(7982)),_N_E=e.O()}]);